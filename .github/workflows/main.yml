name: Contentful CICD workflow
on:
  repository_dispatch:
    types: [contentful.deploy]
jobs:
  use-action:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Fetch API Data ðŸ“¦
      uses: JamesIves/fetch-api-data-action@releases/v1
      with:
          ENDPOINT: https://cdn.contentful.com/spaces/9crgcb5vlu43/environments/master/content_types?access_token=454KcWruKqIb3eQZCXvhfnGkiim7slvEAPtoHFvtvpA
          SAVE_LOCATION: contentful/data.json
    - name: Commit & Push changes
      uses: actions-js/push@master
      with:
        github_token: ${{ secrets.ACCESS_TOKEN }}
        branch: main
        message: 'contentful: autopublish ${date}'
